<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å®æ—¶è–ªèµ„è®¡ç®—å™¨</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'PingFang SC', 'Microsoft YaHei', sans-serif;
        }
        
        body {
            background-color: #f5f7fa;
            color: #333;
            line-height: 1.6;
            padding: 20px;
            transition: background-color 0.3s, color 0.3s;
        }

        body.dark-mode {
            background-color: #2a3441;
            color: #ffffff;
        }
        
        .dark-mode .container {
            background-color: #3a4756;
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.2);
        }
        
        .dark-mode .input-section {
            background-color: #3a4756;
            border-color: #5a6b7e;
        }
        
        .dark-mode input, .dark-mode select {
            background-color: #2a3441;
            color: #ffffff;
            border-color: #5a6b7e;
        }
        
        .dark-mode input:focus, .dark-mode select:focus {
            border-color: #4299e1;
            box-shadow: 0 0 0 3px rgba(66, 153, 225, 0.3);
        }
        
        .dark-mode button {
            background-color: #4299e1;
            color: #ffffff;
        }
        
        .dark-mode button:hover {
            background-color: #3182ce;
        }
        
        .dark-mode .result-card {
            background: linear-gradient(135deg, #4a5d78 0%, #2a3441 100%);
        }
        
        .dark-mode .stat-item {
            background-color: rgba(255, 255, 255, 0.1);
        }

        .dark-mode label {
            color: #e2e8f0;
        }

        .dark-mode .info-text {
            color: #a0aec0;
        }
        
        .dark-mode .settings-summary {
            color: #e2e8f0;
        }
        
        .dark-mode .toggle-settings {
            background-color: #4a5568;
            color: #e2e8f0;
            border-color: #718096;
        }
        
        .dark-mode .toggle-settings:hover {
            background-color: #2d3748;
        }
        
        .dark-mode h1 {
            color: #e2e8f0;
        }
        
        .dark-mode .milestone-bar {
            background-color: rgba(255, 255, 255, 0.2);
        }
        
        .dark-mode .milestone-fill {
            background-color: #48bb78;
        }
        
        .dark-mode .milestone-marker {
            background-color: #ecc94b;
        }
        
        .dark-mode #next-milestone {
            background-color: rgba(255, 255, 255, 0.1);
        }
        
        .top-controls {
            position: fixed;
            top: 10px;
            right: 10px;
            display: flex;
            justify-content: flex-end;
            align-items: center;
            z-index: 1000;
            gap: 10px;
        }

        .dark-mode-toggle {
            background-color: #e2e8f0;
            border: none;
            color: #4a5568;
            font-size: 14px;
            cursor: pointer;
            width: 30px;
            height: 30px;
            border-radius: 4px;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: background-color 0.3s, color 0.3s;
        }
        
        .dark-mode .dark-mode-toggle {
            background-color: #4a5568;
            color: #e2e8f0;
        }

        .language-toggle {
            font-size: 14px;
            width: 30px;
            height: 30px;
            border-radius: 4px;
            background-color: #e2e8f0;
            color: #4a5568;
            border: none;
            cursor: pointer;
            transition: background-color 0.3s, color 0.3s;
            display: flex;
            justify-content: center;
            align-items: center;
            font-weight: bold;
        }

        .dark-mode .language-toggle {
            background-color: #4a5568;
            color: #e2e8f0;
        }
        
        .container {
            max-width: 800px;
            width: 100%;
            margin: 0 auto;
            background-color: #fff;
            border-radius: 12px;
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.1);
            padding: 30px;
            position: relative;
        }
        
        h1 {
            text-align: center;
            margin-bottom: 30px;
            color: #2c3e50;
            font-size: 28px;
        }

        @media (max-width: 768px) {
            body {
                padding: 50px 10px 10px;
            }
            
            .container {
                padding: 20px 15px;
            }
            
            h1 {
                font-size: 24px;
            }
            
            .form-group {
                margin-bottom: 10px;
            }
            
            input, select, button {
                font-size: 14px;
            }
            
            .stat-item {
                min-width: 100%;
                margin: 5px 0;
            }
            
            .top-controls {
                top: 5px;
                right: 5px;
            }
        }
        
        .input-section {
            margin-bottom: 30px;
            background-color: #f8fafc;
            padding: 20px;
            border-radius: 8px;
            border: 1px solid #e2e8f0;
            transition: all 0.3s ease;
        }
        
        .input-section.collapsed {
            padding: 15px;
            margin-bottom: 15px;
        }
        
        .input-section.collapsed .form-group,
        .input-section.collapsed .info-text,
        .input-section.collapsed #start-btn {
            display: none;
        }
        
        .input-section.collapsed .settings-summary {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .settings-summary {
            display: none;
            font-weight: 500;
            color: #4a5568;
        }
        
        .toggle-settings {
            background-color: transparent;
            color: #4a5568;
            border: 1px solid #cbd5e0;
            padding: 8px 15px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            width: auto;
            margin-left: 10px;
        }
        
        .toggle-settings:hover {
            background-color: #edf2f7;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #4a5568;
        }
        
        input, select {
            width: 100%;
            padding: 12px;
            border: 1px solid #cbd5e0;
            border-radius: 6px;
            font-size: 16px;
            transition: border-color 0.3s;
        }
        
        input:focus, select:focus {
            outline: none;
            border-color: #4299e1;
            box-shadow: 0 0 0 3px rgba(66, 153, 225, 0.2);
        }
        
        button {
            background-color: #4299e1;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            width: 100%;
            transition: background-color 0.3s;
        }
        
        button:hover {
            background-color: #3182ce;
        }
        
        .result-section {
            margin-top: 30px;
            text-align: center;
        }
        
        .result-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            position: relative;
            overflow: hidden;
        }
        
        .result-card h2 {
            margin-bottom: 20px;
            font-size: 22px;
        }
        
        .amount {
            font-size: 36px;
            font-weight: 700;
            margin: 15px 0;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }
        
        .stats {
            display: flex;
            justify-content: space-around;
            margin-top: 20px;
            flex-wrap: wrap;
        }
        
        .stat-item {
            flex: 1;
            min-width: 120px;
            margin: 10px;
            padding: 15px;
            background-color: rgba(255, 255, 255, 0.2);
            border-radius: 8px;
        }
        
        .stat-value {
            font-size: 24px;
            font-weight: 700;
            margin: 5px 0;
        }
        
        .stat-label {
            font-size: 14px;
            opacity: 0.9;
        }
        
        .hidden {
            display: none;
        }
        
        .pulse {
            animation: pulse 1s infinite;
        }
        
        @keyframes pulse {
            0% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.05);
            }
            100% {
                transform: scale(1);
            }
        }
        
        .currency {
            font-size: 20px;
            margin-right: 5px;
        }
        
        .info-text {
            margin-top: 10px;
            font-size: 14px;
            color: #718096;
        }
        
        @media (max-width: 600px) {
            .container {
                padding: 20px;
            }
            
            .stats {
                flex-direction: column;
            }
            
            .stat-item {
                margin: 5px 0;
            }
        }
    </style>
</head>
<body>
    <div class="top-controls">
        <button class="dark-mode-toggle" id="dark-mode-toggle">ğŸŒ“</button>
        <button class="language-toggle" id="language-toggle">zh</button>
    </div>
    <div class="container">
        <h1 id="title">å®æ—¶è–ªèµ„è®¡ç®—å™¨</h1>
        
        <div class="input-section" id="input-section">
            <div class="settings-summary" id="settings-summary">
                <span id="summary-text">è–ªèµ„è®¾ç½®</span>
                <button id="toggle-settings" class="toggle-settings">å±•å¼€è®¾ç½®</button>
            </div>
            
            <div class="form-group">
                <label for="salary-type">è–ªèµ„ç±»å‹</label>
                <select id="salary-type">
                    <option value="yearly">å¹´è–ª</option>
                    <option value="monthly" selected>æœˆè–ª</option>
                    <option value="daily">æ—¥è–ª</option>
                    <option value="hourly">æ—¶è–ª</option>
                </select>
            </div>
            
            <div class="form-group">
                <label for="salary-amount">è–ªèµ„é‡‘é¢ (Â¥)</label>
                <input type="number" id="salary-amount" placeholder="è¯·è¾“å…¥è–ªèµ„é‡‘é¢" min="0" step="0.01">
            </div>
            
            <div class="form-group" id="work-hours-group">
                <label for="work-hours">æ¯æ—¥å·¥ä½œæ—¶é•¿ (å°æ—¶)</label>
                <input type="number" id="work-hours" placeholder="è¯·è¾“å…¥æ¯æ—¥å·¥ä½œæ—¶é•¿" min="0" max="24" step="0.5" value="8">
            </div>
            
            <div class="form-group" id="work-days-group">
                <label for="work-days">æ¯å‘¨å·¥ä½œå¤©æ•°</label>
                <input type="number" id="work-days" placeholder="è¯·è¾“å…¥æ¯å‘¨å·¥ä½œå¤©æ•°" min="1" max="7" value="5">
            </div>
            
            <div class="form-group" id="work-start-time-group">
                <label for="work-start-time">ä¸Šç­æ—¶é—´</label>
                <input type="time" id="work-start-time" placeholder="è¯·è¾“å…¥ä¸Šç­æ—¶é—´">
            </div>
            
            <script>
                // è®¾ç½® work-start-time é»˜è®¤å€¼ä¸º 9:00
                document.getElementById('work-start-time').addEventListener('focus', function() {
                    if (!this.value) {
                        this.value = '09:00';
                    }
                });
            </script>
            
        <button id="start-btn">å¼€å§‹è®¡ç®—</button>
            
            <p class="info-text">æç¤ºï¼šè¾“å…¥æ‚¨çš„è–ªèµ„ä¿¡æ¯åï¼Œç‚¹å‡»"å¼€å§‹è®¡ç®—"æŒ‰é’®æŸ¥çœ‹å®æ—¶è–ªèµ„å¢é•¿æƒ…å†µã€‚å¦‚æœå¡«å†™äº†ä¸Šç­æ—¶é—´ï¼Œå°†ä»è¯¥æ—¶é—´å¼€å§‹è®¡ç®—ä»Šæ—¥æ”¶å…¥ã€‚</p>
        </div>
        
        <div class="result-section hidden" id="result-section">
            <div class="result-card">
                <h2 id="salary-growing-text">ğŸ’° è´¢å¯Œæ­£åœ¨æ»šæ»šè€Œæ¥</h2>
                <div class="amount pulse">
                    <span class="currency">Â¥</span><span id="current-amount">0.00</span>
                </div>
                <p id="earned-so-far-text">ğŸ’¼ æ‚¨çš„åŠªåŠ›å·²ç»ä¸ºæ‚¨å¸¦æ¥</p>
                
                <div class="stats">
                    <div class="stat-item">
                        <div class="stat-value" id="per-second">0.00</div>
                        <div class="stat-label">æ¯ç§’ (Â¥)</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="per-minute">0.00</div>
                        <div class="stat-label">æ¯åˆ†é’Ÿ (Â¥)</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="per-hour">0.00</div>
                        <div class="stat-label">æ¯å°æ—¶ (Â¥)</div>
                    </div>
                </div>
                <div class="milestone-section">
                    <h3>é‡Œç¨‹ç¢‘è¿›åº¦</h3>
                    <div class="milestone-progress">
                        <div class="milestone-bar">
                            <div class="milestone-fill"></div>
                        </div>
                        <div class="milestone-markers"></div>
                    </div>
                    <div class="milestone-label">
                        <span id="milestone-text">å½“å‰è¿›åº¦</span>
                        <span id="milestone-amount">Â¥0.00</span>
                    </div>
                    <div id="next-milestone"></div>
                </div>
                <div class="control-buttons">
                    <button id="pause-btn">æš‚åœ</button>
                    <button id="reset-btn">é‡ç½®</button>
                </div>
            </div>
        </div>
    </div>

    <style>
        .control-buttons {
            display: flex;
            justify-content: space-around;
            margin-top: 20px;
        }
        
        .control-buttons button {
            width: 45%;
            margin: 0 5px;
        }

        .milestone-section {
            margin-top: 20px;
            text-align: left;
        }

        .milestone-progress {
            margin-top: 10px;
            position: relative;
        }

        .milestone-bar {
            background-color: rgba(255, 255, 255, 0.3);
            height: 10px;
            border-radius: 5px;
            overflow: hidden;
        }

        .milestone-fill {
            background-color: #4CAF50;
            height: 100%;
            width: 0;
            transition: width 0.5s ease-out;
        }

        .milestone-markers {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 10px;
        }

        .milestone-marker {
            position: absolute;
            width: 12px;
            height: 12px;
            background-color: #FFD700;
            border-radius: 50%;
            top: -1px;
            transform: translateX(-50%);
            transition: background-color 0.3s ease;
        }

        .milestone-marker::after {
            content: attr(data-label);
            position: absolute;
            top: 15px;
            left: 50%;
            transform: translateX(-50%);
            white-space: nowrap;
            font-size: 10px;
            color: #ffffff;
            background-color: rgba(0, 0, 0, 0.7);
            padding: 2px 4px;
            border-radius: 3px;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .milestone-marker:hover::after {
            opacity: 1;
        }

        .milestone-label {
            display: flex;
            justify-content: space-between;
            margin-top: 5px;
            font-size: 14px;
        }

        #next-milestone {
            margin-top: 10px;
            font-size: 14px;
            color: #ffffff;
            text-align: center;
            padding: 5px;
            background-color: rgba(255, 255, 255, 0.2);
            border-radius: 5px;
        }
    </style>

    <script>
        // è·å–DOMå…ƒç´ 
        const salaryTypeEl = document.getElementById('salary-type');
        const salaryAmountEl = document.getElementById('salary-amount');
        const workHoursEl = document.getElementById('work-hours');
        const workDaysEl = document.getElementById('work-days');
        const workHoursGroup = document.getElementById('work-hours-group');
        const workDaysGroup = document.getElementById('work-days-group');
        const startBtn = document.getElementById('start-btn');
        const pauseBtn = document.getElementById('pause-btn');
        const resetBtn = document.getElementById('reset-btn');
        const resultSection = document.getElementById('result-section');
        const currentAmountEl = document.getElementById('current-amount');
        const perSecondEl = document.getElementById('per-second');
        const perMinuteEl = document.getElementById('per-minute');
        const perHourEl = document.getElementById('per-hour');
        const inputSection = document.getElementById('input-section');
        const toggleSettingsBtn = document.getElementById('toggle-settings');
        const settingsSummary = document.getElementById('settings-summary');
        const summaryText = document.getElementById('summary-text');
        
        // è®¡ç®—å™¨çŠ¶æ€
        let isCalculating = false;
        let isPaused = false;
        let startTime;
        let pauseTime;
        let calculationInterval;
        let hourlyRate = 0;
        let isSettingsCollapsed = false;
        let totalPausedTime = 0;
        
        // é‡Œç¨‹ç¢‘æ•°æ®
        const milestones = [
            { amount: 8,   label: { zh: "æ—©é¤è‡ªç”±", en: "Breakfast Freedom" } },
            { amount: 12,  label: { zh: "é€šå‹¤å‚¨å¤‡é‡‘", en: "Commute Fund" } },
            { amount: 18,  label: { zh: "ç»­å‘½å¥¶èŒ¶", en: "Bubble Tea Boost" } },
            { amount: 25,  label: { zh: "ä¾¿åˆ©åº—åŠ é¤", en: "Convenience Store Snack" } },
            { amount: 35,  label: { zh: "å®Œæ•´åˆé¤", en: "Full Lunch" } },
            { amount: 50,  label: { zh: "ä¸‹åˆèŒ¶æ‹¼å•", en: "Afternoon Tea Share" } },
            { amount: 70,  label: { zh: "å¤‡ç”¨å£ç½©é›¨ä¼", en: "Spare Mask and Umbrella" } },
            { amount: 88,  label: { zh: "ç²¾ç¥é£Ÿç²®", en: "Mental Nourishment" } },
            { amount: 100, label: { zh: "åŒäººç”µå½±å¤œ", en: "Movie Night for Two" } },
            { amount: 120, label: { zh: "æ™šé¤ç¤¾äº¤åŸºé‡‘", en: "Dinner Social Fund" } },
            { amount: 150, label: { zh: "é›¶é£Ÿè¡¥ç»™ç«™", en: "Snack Resupply" } },
            { amount: 500, label: { zh: "åº”æ€¥å°é‡‘åº“", en: "Emergency Fund" } }
        ];
        const totalAmount = milestones[milestones.length - 1].amount;

        // æ ¼å¼åŒ–æ•°å­—ä¸ºè´§å¸æ ¼å¼
        function formatCurrency(value) {
            return parseFloat(value).toFixed(2);
        }

        // æ ¼å¼åŒ–æ—¶é—´ä¸º HH:MM:SS æ ¼å¼
        function formatTime(seconds) {
            const hours = Math.floor(seconds / 3600);
            const minutes = Math.floor((seconds % 3600) / 60);
            const remainingSeconds = Math.floor(seconds % 60);
            return `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${remainingSeconds.toString().padStart(2, '0')}`;
        }

        // æ ¹æ®è–ªèµ„ç±»å‹æ˜¾ç¤º/éšè—ç›¸å…³å­—æ®µ
        function updateFieldVisibility() {
            const salaryType = salaryTypeEl.value;
            
            // å¤„ç†æ¯æ—¥å·¥ä½œæ—¶é•¿æ˜¾ç¤º
            if (salaryType === 'hourly') {
                workHoursGroup.style.display = 'none';
            } else {
                workHoursGroup.style.display = 'block';
            }
            
            // å¤„ç†æ¯å‘¨å·¥ä½œå¤©æ•°æ˜¾ç¤º
            if (salaryType === 'daily' || salaryType === 'hourly') {
                workDaysGroup.style.display = 'none';
            } else {
                workDaysGroup.style.display = 'block';
            }
        }

        // è·å–å½“å‰è¯­è¨€
        function getCurrentLanguage() {
            return languageToggle.textContent;
        }
        
        // åˆ‡æ¢è®¾ç½®åŒºåŸŸçš„æŠ˜å çŠ¶æ€
        function toggleSettings() {
            isSettingsCollapsed = !isSettingsCollapsed;
            
            if (isSettingsCollapsed) {
                inputSection.classList.add('collapsed');
                toggleSettingsBtn.textContent = 'å±•å¼€è®¾ç½®';
                updateSettingsSummary();
                // éšè—æ‰€æœ‰è¡¨å•ç»„
                const formGroups = inputSection.querySelectorAll('.form-group');
                formGroups.forEach(group => group.style.display = 'none');
            } else {
                inputSection.classList.remove('collapsed');
                toggleSettingsBtn.textContent = 'æ”¶èµ·è®¾ç½®';
                // æ˜¾ç¤ºæ‰€æœ‰è¡¨å•ç»„
                const formGroups = inputSection.querySelectorAll('.form-group');
                formGroups.forEach(group => group.style.display = 'block');
                // æ›´æ–°å­—æ®µå¯è§æ€§
                updateFieldVisibility();
            }
        }
        
        // æ›´æ–°è®¾ç½®æ‘˜è¦æ–‡æœ¬
        function updateSettingsSummary() {
            const salaryType = salaryTypeEl.value;
            const salaryAmount = parseFloat(salaryAmountEl.value) || 0;
            const currentLang = getCurrentLanguage();
            const texts = languages[currentLang];
            
            let typeText = '';
            switch(salaryType) {
                case 'yearly': typeText = texts.yearly; break;
                case 'monthly': typeText = texts.monthly; break;
                case 'daily': typeText = texts.daily; break;
                case 'hourly': typeText = texts.hourly; break;
            }
            
            summaryText.textContent = `${typeText}: Â¥${formatCurrency(salaryAmount)}`;
        }
        
        // è®¡ç®—æ—¶è–ª
        function calculateHourlyRate() {
            const salaryType = salaryTypeEl.value;
            const salaryAmount = parseFloat(salaryAmountEl.value) || 0;
            const workHours = parseFloat(workHoursEl.value) || 8;
            const workDays = parseFloat(workDaysEl.value) || 5;
            
            let hourly = 0;
            
            switch(salaryType) {
                case 'yearly':
                    // å¹´è–ª Ã· (æ¯å‘¨å·¥ä½œå¤©æ•° Ã— 52å‘¨ Ã— æ¯å¤©å·¥ä½œå°æ—¶)
                    hourly = salaryAmount / (workDays * 52 * workHours);
                    break;
                case 'monthly':
                    // æœˆè–ª Ã· (æ¯å‘¨å·¥ä½œå¤©æ•° Ã— 4.33å‘¨ Ã— æ¯å¤©å·¥ä½œå°æ—¶)
                    hourly = salaryAmount / (workDays * 4.33 * workHours);
                    break;
                case 'daily':
                    // æ—¥è–ª Ã· æ¯å¤©å·¥ä½œå°æ—¶
                    hourly = salaryAmount / workHours;
                    break;
                case 'hourly':
                    // å·²ç»æ˜¯æ—¶è–ª
                    hourly = salaryAmount;
                    break;
            }
            
            return hourly;
        }
        
        // è®¡ç®—å·²ç»èµšå–çš„é‡‘é¢
        function calculateEarnedAmount(startTime) {
            const now = new Date();
            const elapsedSeconds = (now - startTime) / 1000;
            return (hourlyRate / 3600) * elapsedSeconds;
        }

        // å¼€å§‹è®¡ç®—
        function startCalculation() {
            if (isCalculating && !isPaused) return;
            
            const salaryAmount = parseFloat(salaryAmountEl.value);
            if (!salaryAmount || salaryAmount <= 0) {
                alert(languages[getCurrentLanguage()].invalidSalary);
                return;
            }
            
            // è®¡ç®—æ—¶è–ª
            hourlyRate = calculateHourlyRate();
            
            if (isPaused) {
                // å¦‚æœæ˜¯ä»æš‚åœçŠ¶æ€æ¢å¤ï¼Œæ›´æ–°æ€»æš‚åœæ—¶é—´
                totalPausedTime += new Date() - pauseTime;
                pauseBtn.textContent = languages[getCurrentLanguage()].pauseBtn;
            } else {
                // è·å–ä¸Šç­æ—¶é—´
                const workStartTimeEl = document.getElementById('work-start-time');
                const workStartTime = workStartTimeEl.value;
                
                if (workStartTime) {
                    // å¦‚æœè®¾ç½®äº†ä¸Šç­æ—¶é—´ï¼Œè®¡ç®—ä»ä¸Šç­æ—¶é—´å¼€å§‹åˆ°ç°åœ¨çš„æ”¶å…¥
                    const [hours, minutes] = workStartTime.split(':');
                    startTime = new Date();
                    startTime.setHours(parseInt(hours, 10), parseInt(minutes, 10), 0, 0);
                    
                    // å¦‚æœè®¾ç½®çš„æ—¶é—´æ™šäºå½“å‰æ—¶é—´ï¼Œå‡è®¾æ˜¯å‰ä¸€å¤©çš„æ—¶é—´
                    if (startTime > new Date()) {
                        startTime.setDate(startTime.getDate() - 1);
                    }
                } else {
                    // å¦‚æœæ²¡æœ‰è®¾ç½®ä¸Šç­æ—¶é—´ï¼Œä»å½“å‰æ—¶é—´å¼€å§‹è®¡ç®—
                    startTime = new Date();
                }
                
                // æ˜¾ç¤ºç»“æœåŒºåŸŸ
                resultSection.classList.remove('hidden');
                startBtn.classList.add('hidden');
                
                // æŠ˜å æ•´ä¸ªè®¾ç½®åŒºåŸŸ
                inputSection.classList.add('collapsed');
                settingsSummary.style.display = 'flex';
                isSettingsCollapsed = true;
                toggleSettingsBtn.textContent = languages[getCurrentLanguage()].collapseSettings;
                updateSettingsSummary();
                
                // éšè—æ‰€æœ‰è¡¨å•ç»„
                const formGroups = inputSection.querySelectorAll('.form-group');
                formGroups.forEach(group => group.style.display = 'none');
                
                // è®¾ç½®æ¯ç§’ã€æ¯åˆ†é’Ÿã€æ¯å°æ—¶çš„æ”¶å…¥
                const perSecond = hourlyRate / 3600;
                const perMinute = hourlyRate / 60;
                
                perSecondEl.textContent = formatCurrency(perSecond);
                perMinuteEl.textContent = formatCurrency(perMinute);
                perHourEl.textContent = formatCurrency(hourlyRate);
                
                totalPausedTime = 0;
                
                // è®¡ç®—å¹¶æ˜¾ç¤ºå½“å‰å·²èµšå–çš„é‡‘é¢
                const earnedAmount = calculateEarnedAmount(startTime);
                currentAmountEl.textContent = formatCurrency(earnedAmount);
                updateMilestone(earnedAmount);
            }
            
            isCalculating = true;
            isPaused = false;
            
            // è®¾ç½®å®šæ—¶å™¨ï¼Œæ¯100æ¯«ç§’æ›´æ–°ä¸€æ¬¡
            calculationInterval = setInterval(updateAmount, 100);
        }
        
        // æš‚åœè®¡ç®—
        function pauseCalculation() {
            if (!isCalculating || isPaused) return;
            
            clearInterval(calculationInterval);
            isPaused = true;
            pauseTime = new Date();
            pauseBtn.textContent = 'ç»§ç»­';
        }
        
        // æ›´æ–°é‡‘é¢å’Œé‡Œç¨‹ç¢‘
        function updateAmount() {
            if (!isCalculating || isPaused) return;
            
            const earnedAmount = calculateEarnedAmount(startTime) - (hourlyRate / 3600) * (totalPausedTime / 1000);
            currentAmountEl.textContent = formatCurrency(earnedAmount);

            // æ›´æ–°é‡Œç¨‹ç¢‘è¿›åº¦
            updateMilestone(earnedAmount);
        }

        // åˆå§‹åŒ–é‡Œç¨‹ç¢‘æ ‡è®°
        function initializeMilestoneMarkers() {
            const markersContainer = document.querySelector('.milestone-markers');
            markersContainer.innerHTML = ''; // æ¸…ç©ºç°æœ‰çš„æ ‡è®°
            const currentLang = getCurrentLanguage();
            milestones.forEach(milestone => {
                const marker = document.createElement('div');
                marker.className = 'milestone-marker';
                marker.style.left = `${(milestone.amount / totalAmount) * 100}%`;
                marker.setAttribute('data-label', `${milestone.label[currentLang]}: Â¥${milestone.amount}`);
                markersContainer.appendChild(marker);
            });
        }

        // æ›´æ–°é‡Œç¨‹ç¢‘è¿›åº¦
        function updateMilestone(earnedAmount) {
            const currentLang = getCurrentLanguage();
            const texts = languages[currentLang];
            const progress = Math.min(earnedAmount / totalAmount, 1);
            const fillWidth = progress * 100;
            document.querySelector('.milestone-fill').style.width = `${fillWidth}%`;

            document.getElementById('milestone-text').textContent = texts.currentProgress;
            document.getElementById('milestone-amount').textContent = `Â¥${formatCurrency(earnedAmount)}`;

            // æ›´æ–°é‡Œç¨‹ç¢‘æ ‡è®°çš„é¢œè‰²å’Œå¤§å°
            const markers = document.querySelectorAll('.milestone-marker');
            markers.forEach((marker, index) => {
                if (earnedAmount >= milestones[index].amount) {
                    marker.style.backgroundColor = '#4CAF50';
                    marker.style.width = '16px';
                    marker.style.height = '16px';
                    marker.style.top = '-3px';
                } else {
                    marker.style.backgroundColor = '#FFD700';
                    marker.style.width = '12px';
                    marker.style.height = '12px';
                    marker.style.top = '-1px';
                }
            });

            // æ˜¾ç¤ºä¸‹ä¸€ä¸ªé‡Œç¨‹ç¢‘
            const nextMilestone = milestones.find(m => m.amount > earnedAmount);
            if (nextMilestone) {
                const remainingAmount = nextMilestone.amount - earnedAmount;
                const remainingTime = remainingAmount / (hourlyRate / 3600);
                const nextMilestoneText = texts.nextMilestone
                    .replace('{milestone}', nextMilestone.label[currentLang])
                    .replace('{amount}', formatCurrency(remainingAmount))
                    .replace('{time}', formatTime(remainingTime));
                document.getElementById('next-milestone').textContent = nextMilestoneText;
            } else {
                document.getElementById('next-milestone').textContent = texts.allMilestonesReached;
            }
        }
        
        // é‡ç½®è®¡ç®—å™¨
        function resetCalculation() {
            clearInterval(calculationInterval);
            isCalculating = false;
            isPaused = false;
            totalPausedTime = 0;
            
        resultSection.classList.add('hidden');
        startBtn.classList.remove('hidden');
            
            // å±•å¼€è®¾ç½®åŒºåŸŸ
            inputSection.classList.remove('collapsed');
            settingsSummary.style.display = 'none';
            isSettingsCollapsed = false;
            
            // æ˜¾ç¤ºæ‰€æœ‰è¡¨å•ç»„
            const formGroups = inputSection.querySelectorAll('.form-group');
            formGroups.forEach(group => group.style.display = 'block');
            
            // æ›´æ–°å­—æ®µå¯è§æ€§
            updateFieldVisibility();
            
            currentAmountEl.textContent = '0.00';
        }
        
        // äº‹ä»¶ç›‘å¬
        startBtn.addEventListener('click', startCalculation);
        pauseBtn.addEventListener('click', () => {
            if (isPaused) {
                startCalculation();
            } else {
                pauseCalculation();
            }
        });
        resetBtn.addEventListener('click', resetCalculation);
        toggleSettingsBtn.addEventListener('click', toggleSettings);
        
        // è–ªèµ„ç±»å‹å˜åŒ–æ—¶æ›´æ–°å­—æ®µå¯è§æ€§å’Œè®¾ç½®æ‘˜è¦
        salaryTypeEl.addEventListener('change', function() {
            updateFieldVisibility();
            updateSettingsSummary();
            if (isCalculating) {
                resetCalculation();
                startCalculation();
            }
        });
        
        // è¾“å…¥æ¡†å˜åŒ–æ—¶é‡æ–°è®¡ç®—å’Œæ›´æ–°è®¾ç½®æ‘˜è¦
        [salaryAmountEl, workHoursEl, workDaysEl].forEach(el => {
            el.addEventListener('input', function() {
                updateSettingsSummary();
                if (isCalculating) {
                    resetCalculation();
                    startCalculation();
                }
            });
        });
        
        // å¤šè¯­è¨€æ”¯æŒ
        const languageToggle = document.getElementById('language-toggle');
        const languages = {
            zh: {
                title: 'å®æ—¶è–ªèµ„è®¡ç®—å™¨',
                salaryType: 'è–ªèµ„ç±»å‹',
                yearly: 'å¹´è–ª',
                monthly: 'æœˆè–ª',
                daily: 'æ—¥è–ª',
                hourly: 'æ—¶è–ª',
                salaryAmount: 'è–ªèµ„é‡‘é¢ (Â¥)',
                workHours: 'æ¯æ—¥å·¥ä½œæ—¶é•¿ (å°æ—¶)',
                workDays: 'æ¯å‘¨å·¥ä½œå¤©æ•°',
                workStartTime: 'ä¸Šç­æ—¶é—´',
                startBtn: 'å¼€å§‹è®¡ç®—',
                infoText: 'æç¤ºï¼šè¾“å…¥æ‚¨çš„è–ªèµ„ä¿¡æ¯åï¼Œç‚¹å‡»"å¼€å§‹è®¡ç®—"æŒ‰é’®æŸ¥çœ‹å®æ—¶è–ªèµ„å¢é•¿æƒ…å†µã€‚å¦‚æœå¡«å†™äº†ä¸Šç­æ—¶é—´ï¼Œå°†ä»è¯¥æ—¶é—´å¼€å§‹è®¡ç®—ä»Šæ—¥æ”¶å…¥ã€‚',
                salaryGrowing: 'ğŸ’° è´¢å¯Œæ­£åœ¨æ»šæ»šè€Œæ¥',
                earnedSoFar: 'ğŸ’¼ æ‚¨çš„åŠªåŠ›å·²ç»ä¸ºæ‚¨å¸¦æ¥',
                perSecond: 'æ¯ç§’ (Â¥)',
                perMinute: 'æ¯åˆ†é’Ÿ (Â¥)',
                perHour: 'æ¯å°æ—¶ (Â¥)',
                pauseBtn: 'æš‚åœ',
                resetBtn: 'é‡ç½®',
                continueBtn: 'ç»§ç»­',
                expandSettings: 'å±•å¼€è®¾ç½®',
                collapseSettings: 'æ”¶èµ·è®¾ç½®',
                invalidSalary: 'è¯·è¾“å…¥æœ‰æ•ˆçš„è–ªèµ„é‡‘é¢',
                milestoneProgress: 'é‡Œç¨‹ç¢‘è¿›åº¦',
                currentProgress: 'å½“å‰è¿›åº¦',
                nextMilestone: 'è·ç¦»{milestone}è¿˜éœ€ Â¥{amount} ({time})',
                allMilestonesReached: 'æ­å–œï¼æ‚¨å·²è¾¾æˆæ‰€æœ‰é‡Œç¨‹ç¢‘ï¼',
                settingsSummary: 'è–ªèµ„è®¾ç½®ï¼š'
            },
            en: {
                title: 'Real-time Salary Calculator',
                salaryType: 'Salary Type',
                yearly: 'Yearly',
                monthly: 'Monthly',
                daily: 'Daily',
                hourly: 'Hourly',
                salaryAmount: 'Salary Amount (Â¥)',
                workHours: 'Daily Work Hours',
                workDays: 'Weekly Work Days',
                workStartTime: 'Work Start Time',
                startBtn: 'Start Calculation',
                infoText: 'Tip: Enter your salary information, then click "Start Calculation" to see your real-time salary growth. If you enter a work start time, the calculation will begin from that time for today\'s earnings.',
                salaryGrowing: 'ğŸ’° Watch Your Wealth Grow',
                earnedSoFar: 'ğŸ’¼ Your hard work has earned you',
                perSecond: 'Per Second (Â¥)',
                perMinute: 'Per Minute (Â¥)',
                perHour: 'Per Hour (Â¥)',
                pauseBtn: 'Pause',
                resetBtn: 'Reset',
                continueBtn: 'Continue',
                expandSettings: 'Expand Settings',
                collapseSettings: 'Collapse Settings',
                invalidSalary: 'Please enter a valid salary amount',
                milestoneProgress: 'Milestone Progress',
                currentProgress: 'Current Progress',
                nextMilestone: 'Â¥{amount} ({time}) until {milestone}',
                allMilestonesReached: 'Congratulations! You have reached all milestones!',
                settingsSummary: 'Salary Settings: '
            }
        };

        function updateLanguage(lang) {
            const texts = languages[lang];
            document.getElementById('title').textContent = texts.title;
            document.querySelector('label[for="salary-type"]').textContent = texts.salaryType;
            document.querySelector('option[value="yearly"]').textContent = texts.yearly;
            document.querySelector('option[value="monthly"]').textContent = texts.monthly;
            document.querySelector('option[value="daily"]').textContent = texts.daily;
            document.querySelector('option[value="hourly"]').textContent = texts.hourly;
            document.querySelector('label[for="salary-amount"]').textContent = texts.salaryAmount;
            document.querySelector('label[for="work-hours"]').textContent = texts.workHours;
            document.querySelector('label[for="work-days"]').textContent = texts.workDays;
            document.querySelector('label[for="work-start-time"]').textContent = texts.workStartTime;
            startBtn.textContent = texts.startBtn;
            document.querySelector('.info-text').textContent = texts.infoText;
            document.querySelector('.result-card h2').textContent = texts.salaryGrowing;
            document.querySelector('.result-card > p').textContent = texts.earnedSoFar;
            document.querySelectorAll('.stat-label')[0].textContent = texts.perSecond;
            document.querySelectorAll('.stat-label')[1].textContent = texts.perMinute;
            document.querySelectorAll('.stat-label')[2].textContent = texts.perHour;
            pauseBtn.textContent = isPaused ? texts.continueBtn : texts.pauseBtn;
            resetBtn.textContent = texts.resetBtn;
            toggleSettingsBtn.textContent = isSettingsCollapsed ? texts.expandSettings : texts.collapseSettings;

            // æ›´æ–°é‡Œç¨‹ç¢‘ç›¸å…³æ–‡æœ¬
            document.querySelector('.milestone-section h3').textContent = texts.milestoneProgress;
            initializeMilestoneMarkers();
            if (isCalculating) {
                updateMilestone(parseFloat(currentAmountEl.textContent));
            }

            // æ›´æ–°è®¾ç½®æ‘˜è¦
            updateSettingsSummary();
        }

        // åˆå§‹åŒ–
        salaryTypeEl.value = 'monthly'; // è®¾ç½®é»˜è®¤è–ªèµ„ç±»å‹ä¸ºæœˆè–ª
        updateFieldVisibility();

        // æ·±è‰²æ¨¡å¼åˆ‡æ¢
        const darkModeToggle = document.getElementById('dark-mode-toggle');
        const body = document.body;

        darkModeToggle.addEventListener('click', () => {
            body.classList.toggle('dark-mode');
            localStorage.setItem('darkMode', body.classList.contains('dark-mode'));
        });

        // æ£€æŸ¥æœ¬åœ°å­˜å‚¨ä¸­çš„æ·±è‰²æ¨¡å¼è®¾ç½®
        if (localStorage.getItem('darkMode') === 'true') {
            body.classList.add('dark-mode');
        }

        languageToggle.addEventListener('click', function() {
            const currentLang = this.textContent;
            const newLang = currentLang === 'zh' ? 'en' : 'zh';
            this.textContent = newLang;
            updateLanguage(newLang);
            localStorage.setItem('language', newLang);
            updateSettingsSummary(); // æ·»åŠ è¿™ä¸€è¡Œ
        });

        // æ£€æŸ¥æœ¬åœ°å­˜å‚¨ä¸­çš„è¯­è¨€è®¾ç½®
        const savedLanguage = localStorage.getItem('language') || 'zh';
        languageToggle.textContent = savedLanguage;
        updateLanguage(savedLanguage);

        // åˆå§‹åŒ–é‡Œç¨‹ç¢‘æ ‡è®°
        initializeMilestoneMarkers();
    </script>
</body>
</html>
